import random

class Personagem:
    def __init__(self, nome, vida, ataque, especial, especial_nome):
        self.nome = nome
        self.vida = vida
        self.ataque = ataque
        self.especial = especial
        self.especial_nome = especial_nome
        self.especial_usado = False

    def atacar(self, outro):
        dano = random.randint(self.ataque - 2, self.ataque + 2)
        outro.vida -= dano
        print(f"{self.nome} ataca {outro.nome} e causa {dano} de dano!")

    def usar_especial(self, outro):
        if not self.especial_usado:
            dano = self.especial
            outro.vida -= dano
            print(f"{self.nome} usa {self.especial_nome} em {outro.nome} e causa {dano} de dano!")
            self.especial_usado = True
        else:
            print(f"{self.nome} já usou seu ataque especial!")

    def esta_vivo(self):
        return self.vida > 0

def escolher_personagem():
    print("Escolha seu personagem:")
    print("1 - Honrado (Gojo): Vida 30 / Ataque 7 / Especial: 20")
    print("2 - Vessel (Yuji): Vida 35 / Ataque 6 / Especial: 15")
    print("3 - Misterioso: Vida 28 / Ataque 8 / Especial: 18")
    escolha = input("Digite o número do personagem: ")
    if escolha == "1":
        return Personagem("Honrado", 30, 7, 20, "Vazio Infinito")
    elif escolha == "2":
        return Personagem("Vessel", 35, 6, 15, "Impacto Demoníaco")
    else:
        return Personagem("Misterioso", 28, 8, 18, "Sombra Oculta")

def criar_inimigos(jogador_nome):
    personagens = [
        Personagem("Honrado", 30, 7, 20, "Vazio Infinito"),
        Personagem("Vessel", 35, 6, 15, "Impacto Demoníaco"),
        Personagem("Misterioso", 28, 8, 18, "Sombra Oculta"),
    ]
    return [p for p in personagens if p.nome != jogador_nome]

def batalha(jogador, inimigos):
    rodada = 1
    while jogador.esta_vivo() and any(i.esta_vivo() for i in inimigos):
        print(f"\n--- Rodada {rodada} ---")
        print(f"Sua vida: {jogador.vida}")
        print("Inimigos:")
        for i, inimigo in enumerate(inimigos):
            print(f"{i+1} - {inimigo.nome}: Vida {inimigo.vida}{' (morto)' if not inimigo.esta_vivo() else ''}")

        # Escolha do jogador
        vivos = [i for i in inimigos if i.esta_vivo()]
        if not vivos:
            break
        alvo = vivos[0] if len(vivos) == 1 else None
        while alvo is None:
            escolha = input(f"Escolha o inimigo para atacar (1-{len(inimigos)}): ")
            try:
                idx = int(escolha) - 1
                if 0 <= idx < len(inimigos) and inimigos[idx].esta_vivo():
                    alvo = inimigos[idx]
                else:
                    print("Escolha inválida!")
            except:
                print("Digite um número válido.")

        acao = input("Digite 'a' para ataque normal ou 'e' para ataque especial: ")
        if acao == "e":
            jogador.usar_especial(alvo)
        else:
            jogador.atacar(alvo)

        # Inimigos atacam
        for inimigo in inimigos:
            if inimigo.esta_vivo():
                if random.random() < 0.2 and not inimigo.especial_usado:
                    inimigo.usar_especial(jogador)
                else:
                    inimigo.atacar(jogador)
                if not jogador.esta_vivo():
                    break
        rodada += 1

    if jogador.esta_vivo():
        print("\nVocê venceu todos os inimigos!")
    else:
        print("\nVocê foi derrotado...")

if __name__ == "__main__":
    print("Bem-vindo ao Jogo do Abate (Jujutsu Kaisen)!")
    jogador = escolher_personagem()
    inimigos = criar_inimigos(jogador.nome)
    batalha(jogador, inimigos)
