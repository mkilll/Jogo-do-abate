<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gojo Base Skills Demo</title>
  <style>
    body { background: #222; margin: 0; overflow: hidden; }
    #gameCanvas {
      background: linear-gradient(to top, #05182d 80%, #b1eaff 100%);
      display: block;
      margin: 0 auto;
      border: 3px solid #111;
      box-shadow: 0 0 30px #000b;
    }
    #hud {
      position: absolute; top: 14px; left: 50%; transform: translateX(-50%);
      color: #fff; background: #191c; padding: 8px 22px; border-radius: 8px;
      font-size: 18px; font-family: sans-serif; letter-spacing: 1px;
      user-select: none; pointer-events: none; z-index:2;
      min-width: 340px;
      text-align: center;
    }
    #controls {
      position: absolute; top: 60px; left: 50%; transform: translateX(-50%);
      z-index:3;
      display: flex;
      justify-content: center;
      gap: 24px;
      width: 100vw;
      pointer-events: none;
    }
    #spawnBtn {
      pointer-events: auto;
      background: #ffe066;
      color: #222;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      padding: 10px 22px;
      cursor: pointer;
      margin-right:18px;
      box-shadow: 0 0 10px #0005;
      transition: background .18s;
    }
    #spawnBtn:hover {
      background: #ffd60a;
    }
    #skillsHUD {
      position: absolute; top: 110px; left: 50%; transform: translateX(-50%);
      background: #232a; color: #fff; border-radius: 8px; padding: 10px 12px 10px 12px;
      font-size: 15px; z-index:10; min-width: 400px; pointer-events: none;
      font-family: monospace;
      display: flex;
      gap: 10px;
      justify-content: center;
      align-items: flex-end;
    }
    .skillBox {
      background: #191c;
      border: 2px solid #ffe066;
      border-radius: 8px;
      padding: 9px 12px 11px 12px;
      min-width: 90px;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      box-shadow: 0 1px 8px #0008;
      margin-bottom: 2px;
    }
    .skillBox.cooldown {
      border-color: #9e9e9e;
      opacity: .7;
    }
    .skillName {
      font-weight: bold;
      font-size: 15px;
      margin-bottom: 2px;
    }
    .skillKey {
      font-size: 13px;
      background: #ffe066;
      color: #201;
      padding: 1px 8px 1px 8px;
      border-radius: 18px;
      font-weight: bold;
      margin-bottom: 3px;
      margin-top: 2px;
      letter-spacing: 1px;
    }
    .skillR {
      position: absolute; right: 6px; top: 3px; font-size: 13px; color: #ffe066;
      background: #232; border-radius: 7px; padding: 1px 7px;
      font-weight: bold; border: 1px solid #ffe06699;
    }
    .skillCD {
      font-size: 13px;
      margin-top: 2px;
      color: #ffe066;
      background: #232c;
      padding: 1px 7px;
      border-radius: 10px;
      font-weight: bold;
    }
    #hint {
      position: absolute; top: 8px; right: 24px; color: #fff; font-size: 14px;
      font-family: monospace; opacity: .60; pointer-events: none;
    }
    @media (max-width: 700px){
      #gameCanvas { width: 98vw; height: 58vw; }
      #hud, #controls, #skillsHUD { min-width: 0; }
      .skillBox { min-width: 68px; font-size: 12px;}
      .skillName { font-size: 13px;}
    }
  </style>
</head>
<body>
  <div id="hud">
    ← → para andar, espaço para pular, <b>1-5</b> para skills base, <b>R</b> para interações
  </div>
  <div id="hint">
    Use "Spawn Inimigo" para adicionar inimigos.
  </div>
  <div id="controls">
    <button id="spawnBtn">Spawn Inimigo</button>
  </div>
  <div id="skillsHUD"></div>
  <canvas id="gameCanvas" width="700" height="340"></canvas>
  <script>
    // Sprites simples (troque se quiser)
    const gojoColor = "#aaf";
    const enemyColor = "#f55";

    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const GRAVITY = 0.7, GROUND_Y = 256;

    // Player
    const PLAYER = {
      x: 100, y: GROUND_Y, vx: 0, vy: 0,
      w: 36, h: 52,
      dir: 1,
      speed: 2.2, jumpPower: 11,
      grounded: true,
      state: "idle",
      aura: null,
      stunEnemy: null,
      rInteract: null,
      infBarrier: false,
      infTimer: 0,
      teleportActive: false,
      skillTarget: null,
      punchAnim: 0,
      punchTarget: null,
      punchStep: 0,
      punchTimer: 0,
      canAct: true
    };

    // Enemy
    let enemies = [];

    // Skills config
    const skillData = [
      { // Azul
        name: "Azul",
        key: "1",
        cooldown: 8,
        last: -99,
        r: true,
        desc: "Puxa e stuna o inimigo. (R: Chutar)"
      },
      { // Vermelho
        name: "Vermelho",
        key: "2",
        cooldown: 7,
        last: -99,
        r: true,
        desc: "Explosão vermelha (R: Teleportar e lançar invertido)"
      },
      { // Infinito
        name: "Infinito",
        key: "3",
        cooldown: 12,
        last: -99,
        r: false,
        desc: "Barreira: Lentidão nos inimigos"
      },
      { // Socos rápidos
        name: "S. Rápidos",
        key: "4",
        cooldown: 10,
        last: -99,
        r: false,
        desc: "5 socos, o último joga longe"
      },
      { // Teletransporte
        name: "Teleporte",
        key: "5",
        cooldown: 6,
        last: -99,
        r: true,
        desc: "Vai até o inimigo (R: aparecer na frente)"
      }
    ];
    // Skill state
    let now = 0;
    let proj = null, vermProj = null, punchFX = null;

    // Input
    let keys = {};
    document.addEventListener('keydown', e => {
      const k = e.key.toLowerCase();
      keys[k] = true;
      if (["arrowleft","arrowright"," ","1","2","3","4","5","r"].includes(k)) e.preventDefault();
    });
    document.addEventListener('keyup', e => {
      keys[e.key.toLowerCase()] = false;
    });

    // Spawn inimigo botão
    document.getElementById('spawnBtn').onclick = function() {
      spawnEnemy();
    };

    // Skills logic
    function nearestEnemy() {
      let min = 9999, target = null;
      for (let e of enemies) if(e.alive) {
        let d = Math.abs(e.x - PLAYER.x);
        if (d < min) {min = d; target = e;}
      }
      return target;
    }
    function spawnEnemy() {
      let hp = 100+Math.random()*40;
      let px = Math.random() > 0.5 ? canvas.width-60 : 60;
      let side = px > canvas.width/2 ? -1 : 1;
      enemies.push({
        x: px,
        y: GROUND_Y,
        vx: 1.2 * side,
        vy: 0,
        w: 36,
        h: 52,
        alive: true,
        hp: hp,
        mhp: hp,
        stunned: false,
        stunT: 0,
        slow: false,
        slowT: 0,
        col: enemyColor,
        floating: false
      });
    }
    function useSkill(idx) {
      let t = now;
      let data = skillData[idx];
      if (t-data.last < data.cooldown) return;
      // Azul
      if (idx===0) {
        let e = nearestEnemy();
        if (!e) return;
        data.last = t;
        PLAYER.aura = {x:e.x+e.w/2, y:e.y+e.h/2, r:0, max:55, target:e, growing:true};
        PLAYER.stunEnemy = e;
        e.stunned = true; e.stunT = 120;
        e.slow = false;
      }
      // Vermelho
      if (idx===1) {
        let e = nearestEnemy();
        if (!e) return;
        data.last = t;
        vermProj = {
          x: PLAYER.x+PLAYER.w/2+PLAYER.dir*20,
          y: PLAYER.y+30,
          vx: PLAYER.dir*7,
          vy: 0,
          r: 11,
          timer: 0,
          target: e,
          exploded: false
        };
      }
      // Infinito
      if (idx===2) {
        data.last = t;
        PLAYER.infBarrier = true;
        PLAYER.infTimer = 180; // 3s
        for(let e of enemies) {
          if(e.alive && Math.abs(e.x-PLAYER.x)<120) {
            e.slow = true; e.slowT = 180;
          }
        }
      }
      // Socos rápidos
      if (idx===3) {
        let e = nearestEnemy();
        if (!e || Math.abs(e.x-PLAYER.x)>70) return;
        data.last = t;
        PLAYER.punchAnim = 1;
        PLAYER.punchTarget = e;
        PLAYER.punchStep = 0;
        PLAYER.punchTimer = 0;
        PLAYER.canAct = false;
      }
      // Teletransporte
      if (idx===4) {
        let e = nearestEnemy();
        if (!e) return;
        data.last = t;
        PLAYER.teleportActive = true;
        PLAYER.skillTarget = e;
        setTimeout(()=>{
          PLAYER.x = e.x-PLAYER.dir*50;
          PLAYER.y = e.y;
          PLAYER.teleportActive = false;
        },220);
      }
    }
    // Interações R
    function skillR() {
      // Azul: chutar inimigo
      if (PLAYER.stunEnemy && PLAYER.stunEnemy.stunned) {
        PLAYER.stunEnemy.stunned = false;
        PLAYER.stunEnemy.vx = PLAYER.dir*8;
        PLAYER.stunEnemy.vy = -7;
        PLAYER.stunEnemy.slow = false;
        PLAYER.stunEnemy.stunT = 0;
        PLAYER.stunEnemy = null;
      }
      // Vermelho: teleportar atrás e lançar invertido
      else if (vermProj && !vermProj.exploded && vermProj.target && vermProj.target.alive) {
        PLAYER.x = vermProj.target.x + (PLAYER.dir===1?-48:48);
        PLAYER.y = vermProj.target.y-10;
        setTimeout(()=>{
          vermProj.vx = -PLAYER.dir*10;
        }, 220);
      }
      // Teletransporte: Aparecer na frente do inimigo
      else if (PLAYER.skillTarget && PLAYER.skillTarget.alive && PLAYER.teleportActive) {
        PLAYER.x = PLAYER.skillTarget.x + (PLAYER.dir===1?48:-48);
        PLAYER.teleportActive = false;
      }
    }

    // Main loop
    let lastTime = 0;
    function gameLoop(ts) {
      now = ts/1000;

      // Movimento
      if (PLAYER.canAct) {
        if (keys["arrowleft"]) {
          PLAYER.vx = -PLAYER.speed;
          PLAYER.dir = -1;
        } else if (keys["arrowright"]) {
          PLAYER.vx = PLAYER.speed;
          PLAYER.dir = 1;
        } else {
          PLAYER.vx = 0;
        }
        // Pulo
        if ((keys[" "] || keys["arrowup"]) && PLAYER.grounded) {
          PLAYER.vy = -PLAYER.jumpPower;
          PLAYER.grounded = false;
        }
      } else {
        PLAYER.vx = 0;
      }

      // Skills
      for(let i=0;i<5;i++) {
        if (keys[(i+1).toString()]) { useSkill(i); keys[(i+1).toString()] = false; }
      }
      if (keys["r"]) { skillR(); keys["r"]=false; }

      // Aura Azul
      if (PLAYER.aura) {
        if (PLAYER.aura.growing) {
          PLAYER.aura.r += 4;
          if (PLAYER.aura.r >= PLAYER.aura.max) {
            PLAYER.aura.r = PLAYER.aura.max;
            PLAYER.aura.growing = false;
          }
        } else {
          PLAYER.aura.r -= 2;
          if (PLAYER.aura.r <= 0) {
            PLAYER.aura = null;
          }
        }
      }

      // Vermelho
      if (vermProj && !vermProj.exploded) {
        vermProj.x += vermProj.vx;
        vermProj.y += vermProj.vy;
        vermProj.timer++;
        // Explodir em contato
        if (vermProj.target && vermProj.target.alive &&
          vermProj.x + vermProj.r > vermProj.target.x &&
          vermProj.x - vermProj.r < vermProj.target.x + vermProj.target.w &&
          vermProj.y + vermProj.r > vermProj.target.y &&
          vermProj.y - vermProj.r < vermProj.target.y + vermProj.target.h
        ) {
          vermProj.exploded = true;
          vermProj.target.hp -= 35;
          vermProj.target.vx = PLAYER.dir*4;
          vermProj.target.vy = -5;
          vermProj.target.slow = false;
        }
        if (vermProj.x < -40 || vermProj.x > canvas.width+40) vermProj = null;
      } else if (vermProj && vermProj.exploded) {
        vermProj.r += 5;
        if (vermProj.r > 48) vermProj = null;
      }

      // Infinito
      if (PLAYER.infBarrier) {
        PLAYER.infTimer--;
        if (PLAYER.infTimer<=0) PLAYER.infBarrier = false;
      }

      // Socos rápidos
      if (PLAYER.punchAnim) {
        PLAYER.punchTimer++;
        if (PLAYER.punchTarget && PLAYER.punchTarget.alive) {
          if (PLAYER.punchStep<5 && PLAYER.punchTimer%7===0) {
            PLAYER.punchTarget.hp -= 5;
            PLAYER.punchTarget.vx = PLAYER.dir*2;
            PLAYER.punchTarget.vy = -2-Math.random()*2;
            punchFX = {x:PLAYER.punchTarget.x+PLAYER.punchTarget.w/2+Math.random()*18-9, y:PLAYER.punchTarget.y-12, t:12};
            PLAYER.punchStep++;
          }
          if (PLAYER.punchStep===5 && PLAYER.punchTimer===46) {
            PLAYER.punchTarget.hp -= 15;
            PLAYER.punchTarget.vx = PLAYER.dir*12;
            PLAYER.punchTarget.vy = -7;
            punchFX = {x:PLAYER.punchTarget.x+PLAYER.punchTarget.w/2, y:PLAYER.punchTarget.y-16, t:18};
            PLAYER.punchAnim = 0; PLAYER.punchStep = 0; PLAYER.punchTimer = 0; PLAYER.canAct = true;
          }
        } else {
          PLAYER.punchAnim = 0; PLAYER.punchStep = 0; PLAYER.punchTimer = 0; PLAYER.canAct = true;
        }
      }

      // Movimento player
      PLAYER.x += PLAYER.vx;
      PLAYER.y += PLAYER.vy;
      if (!PLAYER.grounded) PLAYER.vy += GRAVITY;
      if (PLAYER.y >= GROUND_Y) {
        PLAYER.y = GROUND_Y;
        PLAYER.vy = 0;
        PLAYER.grounded = true;
      }
      PLAYER.x = Math.max(0, Math.min(canvas.width-PLAYER.w, PLAYER.x));

      // Movimento inimigos
      for (let e of enemies) {
        if (!e.alive) continue;
        if (e.stunned) {
          e.vx = 0; e.vy = 0;
          e.stunT--;
          if (e.stunT<=0) e.stunned = false;
          continue;
        }
        if (e.slow) {
          e.slowT--;
          if (e.slowT<=0) e.slow = false;
        }
        // Lentidão (infinito)
        let speed = e.slow ? .5 : 1.7;
        let dx = PLAYER.x - e.x;
        if (Math.abs(dx) > 8) e.vx = Math.sign(dx) * speed;
        else e.vx = 0;
        e.x += e.vx;
        e.y += e.vy;
        if (e.y < GROUND_Y) e.vy += GRAVITY;
        if (e.y > GROUND_Y) { e.y = GROUND_Y; e.vy = 0; }
        // Dano de soco final pode flutuar
        if (e.hp <= 0) e.alive = false;
      }

      // Punch FX
      if (punchFX) {
        punchFX.t--;
        if (punchFX.t<=0) punchFX = null;
      }

      // Render
      draw();
      renderSkillsHUD();
      requestAnimationFrame(gameLoop);
    }

    // Draw
    function draw() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      // Chão
      ctx.fillStyle = "#4db04d";
      ctx.fillRect(0, GROUND_Y+PLAYER.h-8, canvas.width, 40);

      // Infinito barreira
      if (PLAYER.infBarrier) {
        ctx.save();
        ctx.globalAlpha = 0.13 + 0.09*Math.sin(PLAYER.infTimer/14);
        ctx.beginPath();
        ctx.arc(PLAYER.x+PLAYER.w/2, PLAYER.y+PLAYER.h/2, 95, 0, Math.PI*2);
        ctx.fillStyle = "#b8a8ff";
        ctx.fill();
        ctx.globalAlpha = 1;
        ctx.restore();
      }

      // Aura Azul
      if (PLAYER.aura) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(PLAYER.aura.x, PLAYER.aura.y, PLAYER.aura.r, 0, Math.PI*2);
        ctx.fillStyle = "rgba(100,220,255,0.27)";
        ctx.shadowColor = "#91e8ff";
        ctx.shadowBlur = 30;
        ctx.fill();
        ctx.shadowBlur = 0;
        ctx.restore();
      }

      // Vermelho projétil
      if (vermProj) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(vermProj.x, vermProj.y, vermProj.r, 0, Math.PI*2);
        ctx.fillStyle = vermProj.exploded ? "#ffaaaa" : "#ff4444";
        ctx.shadowColor = "#faa";
        ctx.shadowBlur = 18;
        ctx.globalAlpha = .9;
        ctx.fill();
        ctx.shadowBlur = 0;
        ctx.restore();
      }

      // Punch FX
      if (punchFX) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(punchFX.x, punchFX.y, 11, 0, Math.PI*2);
        ctx.fillStyle = "#fff";
        ctx.globalAlpha = 0.8*punchFX.t/18;
        ctx.shadowColor = "#ffe066";
        ctx.shadowBlur = 12;
        ctx.fill();
        ctx.shadowBlur = 0;
        ctx.restore();
      }

      // Gojo (player)
      ctx.save();
      ctx.fillStyle = gojoColor;
      ctx.shadowColor = "#e0eaff";
      ctx.shadowBlur = 10;
      ctx.fillRect(PLAYER.x, PLAYER.y, PLAYER.w, PLAYER.h);
      ctx.shadowBlur = 0;
      ctx.restore();

      ctx.font = "bold 17px Arial";
      ctx.fillStyle = "#fff";
      ctx.strokeStyle = "#222";
      ctx.lineWidth = 3;
      ctx.strokeText("Gojo", PLAYER.x+2, PLAYER.y-6);
      ctx.fillText("Gojo", PLAYER.x+2, PLAYER.y-6);

      // Inimigos
      for(let e of enemies) {
        if(!e.alive) continue;
        // Sombra
        ctx.save();
        ctx.globalAlpha = 0.17;
        ctx.beginPath();
        ctx.ellipse(e.x+e.w/2, GROUND_Y+e.h-3, 15, 6, 0,0,Math.PI*2);
        ctx.fillStyle = "#000";
        ctx.fill();
        ctx.restore();
        // Corpo
        ctx.save();
        ctx.fillStyle = e.col;
        ctx.globalAlpha = e.stunned ? 0.5 : 1;
        ctx.fillRect(e.x, e.y, e.w, e.h);
        ctx.restore();
        // HP bar
        ctx.save();
        ctx.fillStyle = "#222";
        ctx.fillRect(e.x-3, e.y-13, e.w+6, 9);
        ctx.fillStyle = "#e06666";
        ctx.fillRect(e.x-3, e.y-13, (e.w+6)*e.hp/e.mhp, 9);
        ctx.strokeStyle = "#fff";
        ctx.lineWidth = 2;
        ctx.strokeRect(e.x-3, e.y-13, e.w+6, 9);
        ctx.restore();
      }
    }

    // HUD
    function renderSkillsHUD() {
      const hud = document.getElementById('skillsHUD');
      let t = now;
      let html = "";
      for(let i=0;i<skillData.length;i++) {
        let sk = skillData[i];
        let cd = Math.max(0, sk.cooldown-(t-sk.last));
        html += `<div class="skillBox${cd>0?' cooldown':''}">
          <div class="skillName">${sk.name}</div>
          <div class="skillKey">${sk.key}</div>
          ${sk.r?'<div class="skillR">R</div>':''}
          <div class="skillCD">${cd>0?cd.toFixed(1)+'s':'pronto!'}</div>
          <div style="font-size:12px;margin-top:3px;">${sk.desc}</div>
        </div>`;
      }
      hud.innerHTML = html;
    }

    // Start
    spawnEnemy();
    spawnEnemy();
    requestAnimationFrame(gameLoop);
  </script>
</body>
</html>
