<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gojo Base Skills (Minimal)</title>
  <style>
    body { background: #1c232e; margin: 0; overflow: hidden; }
    #gameCanvas {
      background: linear-gradient(to top, #0a1833 70%, #b1eaff 100%);
      display: block;
      margin: 0 auto;
      border: 2px solid #121a2a;
      box-shadow: 0 0 18px #000a;
    }
    #hud {
      position: absolute; top: 10px; left: 50%; transform: translateX(-50%);
      color: #fff; background: #181c  ; padding: 5px 16px; border-radius: 8px;
      font-size: 14px; font-family: 'Segoe UI', Arial, sans-serif;
      user-select: none; pointer-events: none; z-index:2;
      min-width: 260px; text-align: center;
      letter-spacing: 1px;
    }
    #controls {
      position: absolute; top: 39px; left: 50%; transform: translateX(-50%);
      z-index:3;
      display: flex;
      justify-content: center;
      gap: 14px;
      width: 100vw;
      pointer-events: none;
    }
    #spawnBtn {
      pointer-events: auto;
      background: #ffe066;
      color: #222;
      border: none;
      border-radius: 5px;
      font-size: 13px;
      padding: 5px 15px;
      cursor: pointer;
      margin-right: 10px;
      box-shadow: 0 0 5px #0005;
      transition: background .18s;
    }
    #spawnBtn:hover { background: #ffd60a; }
    #skillsHUD {
      position: absolute; top: 74px; left: 50%; transform: translateX(-50%);
      background: #181e  ; color: #fff; border-radius: 6px; padding: 4px 7px;
      font-size: 11px; z-index:10; min-width: 180px; pointer-events: none;
      font-family: monospace;
      display: flex; gap: 4px; justify-content: center; align-items: flex-end;
    }
    .skillBox {
      background: #111d;
      border: 1px solid #ffe066;
      border-radius: 5px;
      padding: 4px 4px 4px 4px;
      min-width: 44px;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      box-shadow: 0 1px 4px #0003;
      margin-bottom: 2px;
      margin-left: 2px;
      margin-right: 2px;
      transition: border-color .2s, opacity .2s;
    }
    .skillBox.cooldown {
      border-color: #737373;
      opacity: .45;
    }
    .skillName {
      font-weight: 500;
      font-size: 11px;
      margin-bottom: 1px;
      letter-spacing: 0.5px;
    }
    .skillKey {
      font-size: 10px;
      background: #ffe066;
      color: #201;
      padding: 0px 5px 0px 5px;
      border-radius: 9px;
      font-weight: bold;
      margin-bottom: 1px;
      letter-spacing: 1px;
      margin-top: 1px;
    }
    .skillR {
      position: absolute; right: 4px; top: 2px; font-size: 9px; color: #ffe066;
      background: #232; border-radius: 5px; padding: 0px 4px;
      font-weight: 500; border: 1px solid #ffe06670;
    }
    .skillCD {
      font-size: 10px;
      margin-top: 1px;
      color: #ffe066;
      background: #232c;
      padding: 0px 4px;
      border-radius: 7px;
      font-weight: 500;
      letter-spacing: 0.5px;
    }
    #hint {
      position: absolute; top: 5px; right: 18px; color: #fff; font-size: 10px;
      font-family: monospace; opacity: .40; pointer-events: none;
    }
    @media (max-width: 800px){
      #gameCanvas { width: 99vw; height: 44vw; }
      #hud, #controls, #skillsHUD { min-width: 0; }
      .skillBox { min-width: 24px; font-size: 8px; }
      .skillName { font-size: 9px;}
      .skillCD, .skillKey, .skillR { font-size: 8px;}
    }
  </style>
</head>
<body>
  <div id="hud">
    ← → para andar, espaço para pular, <b>1-5</b> para skills, <b>R</b> para interações
  </div>
  <div id="hint">Use "Spawn Inimigo" para adicionar inimigos.</div>
  <div id="controls">
    <button id="spawnBtn">Spawn Inimigo</button>
  </div>
  <div id="skillsHUD"></div>
  <canvas id="gameCanvas" width="2000" height="700"></canvas>
  <script>
    // Sprites simples (troque se quiser)
    const gojoColor = "#aaf";
    const enemyColor = "#f55";

    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const GRAVITY = 0.7, GROUND_Y = 470;

    // Player
    const PLAYER = {
      x: 200, y: GROUND_Y, vx: 0, vy: 0,
      w: 24, h: 35,
      dir: 1,
      speed: 2.2, jumpPower: 10,
      grounded: true,
      state: "idle",
      aura: null,
      stunEnemy: null,
      rInteract: null,
      infBarrier: false,
      infTimer: 0,
      teleportActive: false,
      skillTarget: null,
      punchAnim: 0,
      punchTarget: null,
      punchStep: 0,
      punchTimer: 0,
      canAct: true
    };

    // Enemy
    let enemies = [];

    // Skills config
    const skillData = [
      { // Azul
        name: "Azul",
        key: "1",
        cooldown: 8,
        last: -99,
        r: true,
        desc: "Puxar+Stun<br>R:Chute"
      },
      { // Vermelho
        name: "Verm.",
        key: "2",
        cooldown: 7,
        last: -99,
        r: true,
        desc: "Explode<br>R:TP/bola"
      },
      { // Infinito
        name: "Inf.",
        key: "3",
        cooldown: 12,
        last: -99,
        r: false,
        desc: "Barreira: lento"
      },
      { // Socos
        name: "Socos",
        key: "4",
        cooldown: 10,
        last: -99,
        r: false,
        desc: "5x + socão"
      },
      { // Teleporte
        name: "TP",
        key: "5",
        cooldown: 6,
        last: -99,
        r: true,
        desc: "TP<br>R:frente"
      }
    ];
    // Skill state
    let now = 0;
    let proj = null, vermProj = null, punchFX = null;

    // Input
    let keys = {};
    document.addEventListener('keydown', e => {
      const k = e.key.toLowerCase();
      keys[k] = true;
      if (["arrowleft","arrowright"," ","1","2","3","4","5","r"].includes(k)) e.preventDefault();
    });
    document.addEventListener('keyup', e => {
      keys[e.key.toLowerCase()] = false;
    });

    // Spawn inimigo botão
    document.getElementById('spawnBtn').onclick = function() {
      spawnEnemy();
    };

    // Skills logic
    function nearestEnemy() {
      let min = 9999, target = null;
      for (let e of enemies) if(e.alive) {
        let d = Math.abs(e.x - PLAYER.x);
        if (d < min) {min = d; target = e;}
      }
      return target;
    }
    function spawnEnemy() {
      let hp = 60+Math.random()*35;
      let px = Math.random() > 0.5 ? canvas.width-80 : 80;
      let side = px > canvas.width/2 ? -1 : 1;
      enemies.push({
        x: px,
        y: GROUND_Y,
        vx: 1.1 * side,
        vy: 0,
        w: 24,
        h: 35,
        alive: true,
        hp: hp,
        mhp: hp,
        stunned: false,
        stunT: 0,
        slow: false,
        slowT: 0,
        col: enemyColor,
        floating: false
      });
    }
    function useSkill(idx) {
      let t = now;
      let data = skillData[idx];
      if (t-data.last < data.cooldown) return;
      // Azul
      if (idx===0) {
        let e = nearestEnemy();
        if (!e) return;
        data.last = t;
        PLAYER.aura = {x:e.x+e.w/2, y:e.y+e.h/2, r:0, max:38, target:e, growing:true};
        PLAYER.stunEnemy = e;
        e.stunned = true; e.stunT = 100;
        e.slow = false;
      }
      // Vermelho
      if (idx===1) {
        let e = nearestEnemy();
        if (!e) return;
        data.last = t;
        vermProj = {
          x: PLAYER.x+PLAYER.w/2+PLAYER.dir*13,
          y: PLAYER.y+19,
          vx: PLAYER.dir*6,
          vy: 0,
          r: 7,
          timer: 0,
          target: e,
          exploded: false
        };
      }
      // Infinito
      if (idx===2) {
        data.last = t;
        PLAYER.infBarrier = true;
        PLAYER.infTimer = 110; // 2s
        for(let e of enemies) {
          if(e.alive && Math.abs(e.x-PLAYER.x)<70) {
            e.slow = true; e.slowT = 110;
          }
        }
      }
      // Socos rápidos
      if (idx===3) {
        let e = nearestEnemy();
        if (!e || Math.abs(e.x-PLAYER.x)>38) return;
        data.last = t;
        PLAYER.punchAnim = 1;
        PLAYER.punchTarget = e;
        PLAYER.punchStep = 0;
        PLAYER.punchTimer = 0;
        PLAYER.canAct = false;
      }
      // Teletransporte
      if (idx===4) {
        let e = nearestEnemy();
        if (!e) return;
        data.last = t;
        PLAYER.teleportActive = true;
        PLAYER.skillTarget = e;
        setTimeout(()=>{
          PLAYER.x = e.x-PLAYER.dir*30;
          PLAYER.y = e.y;
          PLAYER.teleportActive = false;
        },120);
      }
    }
    // Interações R
    function skillR() {
      // Azul: chutar inimigo
      if (PLAYER.stunEnemy && PLAYER.stunEnemy.stunned) {
        PLAYER.stunEnemy.stunned = false;
        PLAYER.stunEnemy.vx = PLAYER.dir*7;
        PLAYER.stunEnemy.vy = -6;
        PLAYER.stunEnemy.slow = false;
        PLAYER.stunEnemy.stunT = 0;
        PLAYER.stunEnemy = null;
      }
      // Vermelho: teleportar atrás e lançar invertido
      else if (vermProj && !vermProj.exploded && vermProj.target && vermProj.target.alive) {
        PLAYER.x = vermProj.target.x + (PLAYER.dir===1?-28:28);
        PLAYER.y = vermProj.target.y-6;
        setTimeout(()=>{
          vermProj.vx = -PLAYER.dir*9;
        }, 130);
      }
      // Teletransporte: Aparecer na frente do inimigo
      else if (PLAYER.skillTarget && PLAYER.skillTarget.alive && PLAYER.teleportActive) {
        PLAYER.x = PLAYER.skillTarget.x + (PLAYER.dir===1?28:-28);
        PLAYER.teleportActive = false;
      }
    }

    // Main loop
    let lastTime = 0;
    function gameLoop(ts) {
      now = ts/1000;

      // Movimento
      if (PLAYER.canAct) {
        if (keys["arrowleft"]) {
          PLAYER.vx = -PLAYER.speed;
          PLAYER.dir = -1;
        } else if (keys["arrowright"]) {
          PLAYER.vx = PLAYER.speed;
          PLAYER.dir = 1;
        } else {
          PLAYER.vx = 0;
        }
        // Pulo
        if ((keys[" "] || keys["arrowup"]) && PLAYER.grounded) {
          PLAYER.vy = -PLAYER.jumpPower;
          PLAYER.grounded = false;
        }
      } else {
        PLAYER.vx = 0;
      }

      // Skills
      for(let i=0;i<5;i++) {
        if (keys[(i+1).toString()]) { useSkill(i); keys[(i+1).toString()] = false; }
      }
      if (keys["r"]) { skillR(); keys["r"]=false; }

      // Aura Azul
      if (PLAYER.aura) {
        if (PLAYER.aura.growing) {
          PLAYER.aura.r += 2.9;
          if (PLAYER.aura.r >= PLAYER.aura.max) {
            PLAYER.aura.r = PLAYER.aura.max;
            PLAYER.aura.growing = false;
          }
        } else {
          PLAYER.aura.r -= 1.5;
          if (PLAYER.aura.r <= 0) {
            PLAYER.aura = null;
          }
        }
      }

      // Vermelho
      if (vermProj && !vermProj.exploded) {
        vermProj.x += vermProj.vx;
        vermProj.y += vermProj.vy;
        vermProj.timer++;
        // Explodir em contato
        if (vermProj.target && vermProj.target.alive &&
          vermProj.x + vermProj.r > vermProj.target.x &&
          vermProj.x - vermProj.r < vermProj.target.x + vermProj.target.w &&
          vermProj.y + vermProj.r > vermProj.target.y &&
          vermProj.y - vermProj.r < vermProj.target.y + vermProj.target.h
        ) {
          vermProj.exploded = true;
          vermProj.target.hp -= 22;
          vermProj.target.vx = PLAYER.dir*3;
          vermProj.target.vy = -4;
          vermProj.target.slow = false;
        }
        if (vermProj.x < -30 || vermProj.x > canvas.width+30) vermProj = null;
      } else if (vermProj && vermProj.exploded) {
        vermProj.r += 3;
        if (vermProj.r > 32) vermProj = null;
      }

      // Infinito
      if (PLAYER.infBarrier) {
        PLAYER.infTimer--;
        if (PLAYER.infTimer<=0) PLAYER.infBarrier = false;
      }

      // Socos rápidos
      if (PLAYER.punchAnim) {
        PLAYER.punchTimer++;
        if (PLAYER.punchTarget && PLAYER.punchTarget.alive) {
          if (PLAYER.punchStep<5 && PLAYER.punchTimer%6===0) {
            PLAYER.punchTarget.hp -= 3.5;
            PLAYER.punchTarget.vx = PLAYER.dir*1.5;
            PLAYER.punchTarget.vy = -1.5-Math.random()*1.5;
            punchFX = {x:PLAYER.punchTarget.x+PLAYER.punchTarget.w/2+Math.random()*8-4, y:PLAYER.punchTarget.y-6, t:7};
            PLAYER.punchStep++;
          }
          if (PLAYER.punchStep===5 && PLAYER.punchTimer===30) {
            PLAYER.punchTarget.hp -= 7;
            PLAYER.punchTarget.vx = PLAYER.dir*7;
            PLAYER.punchTarget.vy = -4;
            punchFX = {x:PLAYER.punchTarget.x+PLAYER.punchTarget.w/2, y:PLAYER.punchTarget.y-8, t:10};
            PLAYER.punchAnim = 0; PLAYER.punchStep = 0; PLAYER.punchTimer = 0; PLAYER.canAct = true;
          }
        } else {
          PLAYER.punchAnim = 0; PLAYER.punchStep = 0; PLAYER.punchTimer = 0; PLAYER.canAct = true;
        }
      }

      // Movimento player
      PLAYER.x += PLAYER.vx;
      PLAYER.y += PLAYER.vy;
      if (!PLAYER.grounded) PLAYER.vy += GRAVITY;
      if (PLAYER.y >= GROUND_Y) {
        PLAYER.y = GROUND_Y;
        PLAYER.vy = 0;
        PLAYER.grounded = true;
      }
      PLAYER.x = Math.max(0, Math.min(canvas.width-PLAYER.w, PLAYER.x));

      // Movimento inimigos
      for (let e of enemies) {
        if (!e.alive) continue;
        if (e.stunned) {
          e.vx = 0; e.vy = 0;
          e.stunT--;
          if (e.stunT<=0) e.stunned = false;
          continue;
        }
        if (e.slow) {
          e.slowT--;
          if (e.slowT<=0) e.slow = false;
        }
        // Lentidão (infinito)
        let speed = e.slow ? .33 : 1.12;
        let dx = PLAYER.x - e.x;
        if (Math.abs(dx) > 6) e.vx = Math.sign(dx) * speed;
        else e.vx = 0;
        e.x += e.vx;
        e.y += e.vy;
        if (e.y < GROUND_Y) e.vy += GRAVITY;
        if (e.y > GROUND_Y) { e.y = GROUND_Y; e.vy = 0; }
        if (e.hp <= 0) e.alive = false;
      }

      // Punch FX
      if (punchFX) {
        punchFX.t--;
        if (punchFX.t<=0) punchFX = null;
      }

      // Render
      draw();
      renderSkillsHUD();
      requestAnimationFrame(gameLoop);
    }

    // Draw
    function draw() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      // Chão
      ctx.fillStyle = "#4db04d";
      ctx.fillRect(0, GROUND_Y+PLAYER.h-8, canvas.width, 40);

      // Infinito barreira
      if (PLAYER.infBarrier) {
        ctx.save();
        ctx.globalAlpha = 0.10 + 0.08*Math.sin(PLAYER.infTimer/15);
        ctx.beginPath();
        ctx.arc(PLAYER.x+PLAYER.w/2, PLAYER.y+PLAYER.h/2, 55, 0, Math.PI*2);
        ctx.fillStyle = "#b8a8ff";
        ctx.fill();
        ctx.globalAlpha = 1;
        ctx.restore();
      }

      // Aura Azul
      if (PLAYER.aura) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(PLAYER.aura.x, PLAYER.aura.y, PLAYER.aura.r, 0, Math.PI*2);
        ctx.fillStyle = "rgba(100,220,255,0.18)";
        ctx.shadowColor = "#91e8ff";
        ctx.shadowBlur = 12;
        ctx.fill();
        ctx.shadowBlur = 0;
        ctx.restore();
      }

      // Vermelho projétil
      if (vermProj) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(vermProj.x, vermProj.y, vermProj.r, 0, Math.PI*2);
        ctx.fillStyle = vermProj.exploded ? "#ffaaaa" : "#ff4444";
        ctx.shadowColor = "#faa";
        ctx.shadowBlur = 8;
        ctx.globalAlpha = .8;
        ctx.fill();
        ctx.shadowBlur = 0;
        ctx.restore();
      }

      // Punch FX
      if (punchFX) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(punchFX.x, punchFX.y, 6, 0, Math.PI*2);
        ctx.fillStyle = "#fff";
        ctx.globalAlpha = 0.7*punchFX.t/10;
        ctx.shadowColor = "#ffe066";
        ctx.shadowBlur = 4;
        ctx.fill();
        ctx.shadowBlur = 0;
        ctx.restore();
      }

      // Gojo (player)
      ctx.save();
      ctx.fillStyle = gojoColor;
      ctx.shadowColor = "#e0eaff";
      ctx.shadowBlur = 5;
      ctx.fillRect(PLAYER.x, PLAYER.y, PLAYER.w, PLAYER.h);
      ctx.shadowBlur = 0;
      ctx.restore();

      ctx.font = "bold 11px Arial";
      ctx.fillStyle = "#fff";
      ctx.strokeStyle = "#222";
      ctx.lineWidth = 2;
      ctx.strokeText("Gojo", PLAYER.x+2, PLAYER.y-4);
      ctx.fillText("Gojo", PLAYER.x+2, PLAYER.y-4);

      // Inimigos
      for(let e of enemies) {
        if(!e.alive) continue;
        // Sombra
        ctx.save();
        ctx.globalAlpha = 0.13;
        ctx.beginPath();
        ctx.ellipse(e.x+e.w/2, GROUND_Y+e.h-2, 9, 4, 0,0,Math.PI*2);
        ctx.fillStyle = "#000";
        ctx.fill();
        ctx.restore();
        // Corpo
        ctx.save();
        ctx.fillStyle = e.col;
        ctx.globalAlpha = e.stunned ? 0.5 : 1;
        ctx.fillRect(e.x, e.y, e.w, e.h);
        ctx.restore();
        // HP bar
        ctx.save();
        ctx.fillStyle = "#222";
        ctx.fillRect(e.x-2, e.y-8, e.w+4, 4);
        ctx.fillStyle = "#e06666";
        ctx.fillRect(e.x-2, e.y-8, (e.w+4)*e.hp/e.mhp, 4);
        ctx.strokeStyle = "#fff";
        ctx.lineWidth = 1;
        ctx.strokeRect(e.x-2, e.y-8, e.w+4, 4);
        ctx.restore();
      }
    }

    // HUD
    function renderSkillsHUD() {
      const hud = document.getElementById('skillsHUD');
      let t = now;
      let html = "";
      for(let i=0;i<skillData.length;i++) {
        let sk = skillData[i];
        let cd = Math.max(0, sk.cooldown-(t-sk.last));
        html += `<div class="skillBox${cd>0?' cooldown':''}">
          <div class="skillName">${sk.name}</div>
          <div class="skillKey">${sk.key}</div>
          ${sk.r?'<div class="skillR">R</div>':''}
          <div class="skillCD">${cd>0?cd.toFixed(1)+'s':'ok'}</div>
        </div>`;
      }
      hud.innerHTML = html;
    }

    // Start
    spawnEnemy();
    spawnEnemy();
    requestAnimationFrame(gameLoop);
  </script>
</body>
</html>
