<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gojo Awakening System Demo</title>
  <style>
    body { background: #141b26; margin: 0; overflow: hidden; }
    #gameCanvas {
      background: linear-gradient(to top, #111a 84%, #b1eaff 100%);
      display: block;
      margin: 0 auto;
      border: 2px solid #121a2a;
      box-shadow: 0 0 18px #000a;
      touch-action: none;
    }
    #hud {
      position: absolute; top: 12px; left: 50%; transform: translateX(-50%);
      color: #fff; background: #181c  ; padding: 6px 16px; border-radius: 10px;
      font-size: 14px; font-family: Arial, sans-serif;
      user-select: none; pointer-events: none; z-index:2;
      min-width: 240px; text-align: center;
      letter-spacing: 1px;
    }
    #spawnBtn {
      position: absolute; top: 16px; left: 25px;
      background: #ffe066;
      color: #222;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      padding: 6px 16px;
      cursor: pointer;
      box-shadow: 0 0 8px #0002;
      z-index: 3;
      transition: background .18s;
    }
    #spawnBtn:hover { background: #ffd60a; }
    #skillsHUD {
      position: absolute; bottom: 58px; right: 30px;
      background: #181e; color: #fff; border-radius: 8px; padding: 9px 16px 5px 16px;
      font-size: 13px; z-index:10; min-width: 185px;
      font-family: monospace;
      pointer-events: none;
      box-shadow: 0 1px 8px #0006;
      opacity: .96;
    }
    .skillLine {
      margin: 0px 0 2px 0;
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
      color: #ffe066;
    }
    .skKey { background: #ffe066; color: #222; font-weight: bold; border-radius: 6px;
      padding: 0 5px 0 5px; font-size: 12px; margin-right: 2px;}
    .skCD { color: #69e1ff; font-size: 11px; padding: 0 3px; }
    .skLock { color: #888;}
    #awkBarWrap {
      position: absolute; left: 50%; bottom: 16px; transform: translateX(-50%);
      width: 50vw; max-width: 520px; height: 20px; background: #232b;
      border-radius: 12px; border: 2px solid #1f2a3a;
      display: flex; align-items: center;
      box-shadow: 0 0 12px #0006;
      z-index: 5;
    }
    #awkBar {
      height: 100%; border-radius: 12px 0 0 12px;
      background: linear-gradient(90deg,#84e2ff 0%,#8f6fff 100%);
      transition: width .19s;
    }
    #awkText {
      position: absolute; width: 100%; text-align: center;
      color: #ffe066; font-weight: bold; font-size: 16px;
      letter-spacing: 1px;
      text-shadow: 0 0 8px #101c;
      left: 0; top: 0; pointer-events: none;
    }
    #awkReady {
      position: absolute; left: 50%; bottom: 40px; transform: translateX(-50%);
      color: #ffe066; font-size: 23px; font-weight: bold; text-shadow: 0 0 12px #fff7, 0 0 8px #ffe066;
      z-index: 7;
      letter-spacing: 1px;
      display: none;
      pointer-events: none;
    }
    @media (max-width: 900px){
      #gameCanvas { width: 98vw; height: 43vw; }
      #hud, #skillsHUD, #awkBarWrap { min-width: 0; }
      #skillsHUD { right: 7vw; }
    }
  </style>
</head>
<body>
  <div id="hud">
    ← → para andar, espaço para pular, <b>1-4</b> para skills (na forma Awk), <b>R</b> interage, <b>G</b> desperta
  </div>
  <button id="spawnBtn">Spawn Inimigo</button>
  <div id="skillsHUD"></div>
  <div id="awkBarWrap">
    <div id="awkBar" style="width:0%"></div>
    <div id="awkText"></div>
  </div>
  <div id="awkReady">Aperte <b>G</b> para acordar!</div>
  <canvas id="gameCanvas" width="1700" height="600"></canvas>
  <script>
    // --- CONFIG ---
    const BASE_COLOR = "#aaf";
    const ENEMY_COLOR = "#f55";
    const mapWidth = 1700, mapHeight = 600, groundY = 430;
    // Gojo "minimal detalhado"
    function drawGojo(x, y, w, h, dir, awakened) {
      ctx.save();
      ctx.translate(x+w/2, y+h/2);
      ctx.scale(dir,1);
      // sombra
      ctx.save();
      ctx.globalAlpha = 0.14;
      ctx.beginPath();
      ctx.ellipse(0, h/2-4, w*0.54, h*0.16, 0,0,Math.PI*2);
      ctx.fillStyle = "#000";
      ctx.fill();
      ctx.restore();
      // Corpo
      ctx.fillStyle = awakened ? "#ccd7ff" : BASE_COLOR;
      ctx.strokeStyle = "#222";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(-w/2+4, h/2-7); ctx.lineTo(-w/2+4, -h/2+14); ctx.lineTo(-w/6, -h/2+1);
      ctx.lineTo(w/6, -h/2+1); ctx.lineTo(w/2-4, -h/2+14); ctx.lineTo(w/2-4, h/2-7);
      ctx.closePath(); ctx.fill(); ctx.stroke();
      // Cabeça
      ctx.save();
      ctx.beginPath();
      ctx.ellipse(0, -h/2+12, w/3.1, h/3.5, 0, 0, Math.PI*2);
      ctx.fillStyle = "#fff";
      ctx.fill();
      // Máscara
      ctx.fillStyle = "#111";
      ctx.fillRect(-w/3.1, -h/2+8, w/1.55, h/8.5);
      // Olhos
      ctx.beginPath();
      ctx.arc(-w/9, -h/2+13, 2, 0, Math.PI*2);
      ctx.arc(w/9, -h/2+13, 2, 0, Math.PI*2);
      ctx.fillStyle = awakened ? "#95e7ff" : "#aaf";
      ctx.fill();
      // Cabelo
      ctx.beginPath();
      ctx.moveTo(-w/4, -h/2+9); ctx.lineTo(0, -h/2-7);
      ctx.lineTo(w/4, -h/2+9); ctx.lineTo(0, -h/2+6); ctx.closePath();
      ctx.fillStyle = "#e8f3ff";
      ctx.fill();
      ctx.restore();
      ctx.restore();
    }
    // Enemy model: mais detalhado
    function drawEnemy(e) {
      ctx.save();
      ctx.translate(e.x+e.w/2, e.y+e.h/2);
      // sombra
      ctx.globalAlpha = 0.13;
      ctx.beginPath();
      ctx.ellipse(0, e.h/2-3, e.w*0.54, e.h*0.15, 0,0,Math.PI*2);
      ctx.fillStyle = "#000";
      ctx.fill();
      ctx.globalAlpha = 1;
      // corpo
      ctx.fillStyle = e.color;
      ctx.strokeStyle = "#222";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.ellipse(0, 0, e.w/2-1, e.h/2-2.5, 0, 0, Math.PI*2);
      ctx.fill(); ctx.stroke();
      // Cabeça
      ctx.beginPath();
      ctx.arc(0, -e.h/2+9, e.w/3.1, 0, Math.PI*2);
      ctx.fillStyle = "#f7e2d6";
      ctx.fill();
      // Olhos
      ctx.beginPath();
      ctx.arc(-e.w/11, -e.h/2+11, 1.2, 0, Math.PI*2);
      ctx.arc(e.w/11, -e.h/2+11, 1.2, 0, Math.PI*2);
      ctx.fillStyle = "#000";
      ctx.fill();
      ctx.restore();
    }
    // --- PLAYER ---
    const PLAYER = {
      x: 200, y: groundY, vx: 0, vy: 0,
      w: 38, h: 62,
      dir: 1,
      speed: 2.2, jumpPower: 11,
      grounded: true,
      state: "idle",
      canAct: true,
      awk: 0, awkMax: 100,
      awakened: false,
      awkTimer: 0,
      awkCD: [0,0,0,0], // cooldowns 1-4
      awkLock: [false, false, false, false],
      blueSky: false,
      blueSkyObj: null,
      blueComboReady: false,
      redHold: false,
      redObj: null,
      redCombo: false,
      purpleObj: null,
      purpleHold: false,
      purpleSize: 18,
      infField: null
    };

    // --- ENEMIES ---
    let enemies = [];

    function spawnEnemy() {
      let hp = 65+Math.random()*45;
      let px = Math.random() > 0.5 ? mapWidth-130 : 130;
      let side = px > mapWidth/2 ? -1 : 1;
      enemies.push({
        x: px,
        y: groundY,
        vx: 1.09 * side,
        vy: 0,
        w: 35,
        h: 49,
        alive: true,
        hp: hp,
        mhp: hp,
        stunned: false,
        stunT: 0,
        slow: false,
        slowT: 0,
        color: "#f55",
        frozen: false
      });
    }
    document.getElementById('spawnBtn').onclick = spawnEnemy;

    // --- INPUT ---
    let keys = {};
    document.addEventListener('keydown', e => {
      const k = e.key.toLowerCase();
      keys[k] = true;
      if (["arrowleft","arrowright"," ","1","2","3","4","r","g"].includes(k)) e.preventDefault();
    });
    document.addEventListener('keyup', e => {
      keys[e.key.toLowerCase()] = false;
    });

    // --- GAME LOOP ---
    let now = 0;
    function gameLoop(ts) {
      now = ts/1000;

      // --- MOVIMENTO ---
      if (PLAYER.canAct && !PLAYER.awakened) {
        if (keys["arrowleft"]) { PLAYER.vx = -PLAYER.speed; PLAYER.dir = -1; }
        else if (keys["arrowright"]) { PLAYER.vx = PLAYER.speed; PLAYER.dir = 1; }
        else PLAYER.vx = 0;

        if ((keys[" "] || keys["arrowup"]) && PLAYER.grounded) {
          PLAYER.vy = -PLAYER.jumpPower;
          PLAYER.grounded = false;
        }
      } else if (PLAYER.canAct && PLAYER.awakened) {
        if (keys["arrowleft"]) { PLAYER.vx = -PLAYER.speed-0.4; PLAYER.dir = -1; }
        else if (keys["arrowright"]) { PLAYER.vx = PLAYER.speed+0.5; PLAYER.dir = 1; }
        else PLAYER.vx = 0;

        if ((keys[" "] || keys["arrowup"]) && PLAYER.grounded) {
          PLAYER.vy = -PLAYER.jumpPower-1.7;
          PLAYER.grounded = false;
        }
      } else { PLAYER.vx = 0; }

      // --- COLISOES MAPA ---
      PLAYER.x += PLAYER.vx;
      PLAYER.y += PLAYER.vy;
      if (!PLAYER.grounded) PLAYER.vy += 0.7;
      if (PLAYER.y >= groundY) { PLAYER.y = groundY; PLAYER.vy = 0; PLAYER.grounded = true; }
      PLAYER.x = Math.max(0, Math.min(mapWidth-PLAYER.w, PLAYER.x));

      // --- ENEMY MOV ---
      for (let e of enemies) {
        if (!e.alive) continue;
        if (PLAYER.infField && e.frozen) continue;
        if (e.stunned) { e.vx = 0; e.vy = 0; e.stunT--; if(e.stunT<=0) e.stunned = false; continue; }
        if (e.slow) { e.slowT--; if(e.slowT<=0) e.slow = false; }
        let speed = e.slow ? 0.5 : 1.25;
        let dx = PLAYER.x - e.x;
        if (Math.abs(dx) > 12) e.vx = Math.sign(dx) * speed;
        else e.vx = 0;
        e.x += e.vx;
        e.y += e.vy;
        if (e.y < groundY) e.vy += 0.7;
        if (e.y > groundY) { e.y = groundY; e.vy = 0; }
        if (e.hp <= 0) e.alive = false;
      }

      // --- AWK BARRA ---
      if (!PLAYER.awakened) {
        // Se acertar inimigo, awk += 10
        for (let e of enemies) {
          if (!e.alive) continue;
          let dx = Math.abs(PLAYER.x-e.x);
          if (dx<45 && Math.abs(PLAYER.y-e.y)<35) {
            PLAYER.awk = Math.min(PLAYER.awkMax, PLAYER.awk+0.08);
          }
        }
      }

      // --- AWK UP ---
      if (!PLAYER.awakened && PLAYER.awk >= PLAYER.awkMax && keys["g"]) {
        PLAYER.awakened = true;
        PLAYER.awkTimer = 0;
        PLAYER.awk = PLAYER.awkMax;
        document.getElementById("awkReady").style.display = "none";
        PLAYER.awkCD = [0,0,0,0];
        PLAYER.blueSky = false;
        PLAYER.blueSkyObj = null;
        PLAYER.blueComboReady = false;
        PLAYER.redObj = null;
        PLAYER.redCombo = false;
        PLAYER.purpleObj = null;
        PLAYER.infField = null;
      }

      // --- AWK SKILLS ---
      // 1: Azul Máximo
      if (PLAYER.awakened && keys["1"] && !PLAYER.awkLock[0]) {
        keys["1"]=false; PLAYER.awkLock[0]=true; PLAYER.awkCD[0]=8; // 8s cd
        PLAYER.blueSkyObj = {x: PLAYER.x+PLAYER.w/2, y: PLAYER.y+24, r: 27, t:0, state:0, spins:0};
        PLAYER.blueSky = false; // reset
      }
      // 2: Vermelho Máximo
      if (PLAYER.awakened && keys["2"] && !PLAYER.awkLock[1]) {
        keys["2"]=false; PLAYER.awkLock[1]=true; PLAYER.awkCD[1]=7;
        PLAYER.redObj = {x: PLAYER.x+PLAYER.w/2, y: PLAYER.y+18, r: 10, t:0, state:0, dir:PLAYER.dir, combo: false, target: null};
        PLAYER.redHold = true;
      }
      // 3: Vazio Roxo
      if (PLAYER.awakened && keys["3"] && !PLAYER.awkLock[2]) {
        keys["3"]=false; PLAYER.awkLock[2]=true; PLAYER.awkCD[2]=7;
        PLAYER.purpleObj = {x: PLAYER.x+PLAYER.w/2, y: PLAYER.y+26, r: 18, vx: 0, charging: true, t: 0};
        PLAYER.purpleHold = true;
      }
      // 4: Vazio Infinito
      if (PLAYER.awakened && keys["4"] && !PLAYER.awkLock[3]) {
        keys["4"]=false; PLAYER.awkLock[3]=true; PLAYER.awkCD[3]=14;
        PLAYER.infField = {x: PLAYER.x+PLAYER.w/2, y: PLAYER.y+PLAYER.h/2, r: 170, t:0, active:true};
        for (let e of enemies) {
          if (!e.alive) continue;
          let dx = PLAYER.x+PLAYER.w/2-e.x-e.w/2, dy = PLAYER.y+PLAYER.h/2-e.y-e.h/2;
          if (Math.hypot(dx,dy)<170) e.frozen = true;
        }
      }

      // Azul Máximo: gira 3x e sobe para o céu
      if (PLAYER.blueSkyObj) {
        PLAYER.blueSkyObj.t++;
        if (PLAYER.blueSkyObj.state===0) {
          let angle = (PLAYER.blueSkyObj.t/21) * Math.PI*2; // 1 giro = ~21 frames
          PLAYER.blueSkyObj.x = PLAYER.x+PLAYER.w/2+Math.cos(angle)*54;
          PLAYER.blueSkyObj.y = PLAYER.y+32+Math.sin(angle)*26;
          if (PLAYER.blueSkyObj.t%21===0) PLAYER.blueSkyObj.spins++;
          if (PLAYER.blueSkyObj.spins>=3) { PLAYER.blueSkyObj.state=1; }
        } else if (PLAYER.blueSkyObj.state===1) {
          PLAYER.blueSkyObj.y -= 5;
          if (PLAYER.blueSkyObj.y<60) {
            PLAYER.blueSky = true;
            PLAYER.blueSkyObj.state=2;
            PLAYER.blueSkyObj.t = 0;
          }
        }
        // se sumir do céu após 12s
        if (PLAYER.blueSkyObj.t>380) { PLAYER.blueSkyObj = null; PLAYER.blueSky = false;}
      }

      // Vermelho Máximo: bola na mão -> feixe -> combo com azul
      if (PLAYER.redObj) {
        PLAYER.redObj.t++;
        // Estado 0: carregar na mão
        if (PLAYER.redObj.state===0) {
          if (PLAYER.redObj.t>25) { PLAYER.redObj.state=1; }
        }
        // Estado 1: feixe dispara
        else if (PLAYER.redObj.state===1) {
          // Feixe atinge inimigos à frente
          let fx = PLAYER.redObj.x+PLAYER.redObj.dir*180;
          for (let e of enemies) {
            if (!e.alive) continue;
            let ex = e.x+e.w/2;
            let hit = (PLAYER.redObj.dir>0 && ex>PLAYER.redObj.x && ex<fx) ||
                      (PLAYER.redObj.dir<0 && ex<PLAYER.redObj.x && ex>fx);
            if (hit && Math.abs(e.y-PLAYER.redObj.y)<32) {
              e.hp -= 42; e.stunned = true; e.stunT = 40;
              if (PLAYER.blueSky) PLAYER.blueComboReady = true;
            }
          }
        }
        // Estado Combo: ao apertar R, bola volta, puxa inimigo e soco
        if (PLAYER.redObj.combo) {
          if (PLAYER.redObj.t===75) {
            // Procura inimigo atingido
            let tgt = null;
            for (let e of enemies) {
              if (!e.alive) continue;
              let dx = Math.abs(e.x-PLAYER.redObj.x);
              if (dx<120 && Math.abs(e.y-PLAYER.redObj.y)<40) { tgt = e; break; }
            }
            if (tgt) {
              tgt.x = PLAYER.x+PLAYER.dir*44;
              tgt.hp -= 55; tgt.stunned = true; tgt.stunT = 55;
            }
          }
        }
        // Interação Azul no céu: transformar em Bola Roxa
        if (PLAYER.blueSky && PLAYER.blueComboReady) {
          PLAYER.purpleObj = {x:PLAYER.blueSkyObj.x, y:PLAYER.blueSkyObj.y, r:45, vx:0, charging:false, t:0, explode:true};
          PLAYER.blueSkyObj = null; PLAYER.blueSky = false; PLAYER.blueComboReady = false;
          PLAYER.redObj = null;
        }
        // Finaliza
        if (PLAYER.redObj.t>80) PLAYER.redObj = null;
      }

      // Combo Vermelho: R puxa inimigo e soca
      if (PLAYER.awakened && keys["r"] && PLAYER.redObj && PLAYER.redObj.state===1 && !PLAYER.redObj.combo) {
        PLAYER.redObj.combo = true; PLAYER.redObj.t = 0;
        keys["r"]=false;
      }

      // Vazio Roxo: segurar aumenta bola, soltar lança
      if (PLAYER.purpleObj && PLAYER.purpleObj.charging) {
        if (keys["3"]) {
          if (PLAYER.purpleObj.r<43) PLAYER.purpleObj.r += 1.3;
        } else {
          PLAYER.purpleObj.charging = false;
          PLAYER.purpleObj.vx = 12*PLAYER.dir;
        }
      }
      // Bola roxa explode se for combo com azul/vermelho
      if (PLAYER.purpleObj && PLAYER.purpleObj.explode) {
        PLAYER.purpleObj.t++;
        if (PLAYER.purpleObj.t<22) {
          // Explosão em área
          for (let e of enemies) {
            if (!e.alive) continue;
            let dx=PLAYER.purpleObj.x-(e.x+e.w/2), dy=PLAYER.purpleObj.y-(e.y+e.h/2);
            if (Math.hypot(dx,dy)<PLAYER.purpleObj.r+90) e.hp -= 60;
          }
        }
        if (PLAYER.purpleObj.t>40) PLAYER.purpleObj = null;
      }
      // Lançamento bola roxa normal
      if (PLAYER.purpleObj && !PLAYER.purpleObj.charging && !PLAYER.purpleObj.explode) {
        PLAYER.purpleObj.x += PLAYER.purpleObj.vx;
        for (let e of enemies) {
          if (!e.alive) continue;
          let dx=PLAYER.purpleObj.x-(e.x+e.w/2), dy=PLAYER.purpleObj.y-(e.y+e.h/2);
          if (Math.hypot(dx,dy)<PLAYER.purpleObj.r+8) e.hp -= 25;
        }
        if (PLAYER.purpleObj.x< -60 || PLAYER.purpleObj.x>mapWidth+60) PLAYER.purpleObj = null;
      }

      // Vazio Infinito: campo paralisa todos por 10s
      if (PLAYER.infField) {
        PLAYER.infField.t++;
        if (PLAYER.infField.t>650) {
          for (let e of enemies) e.frozen = false;
          PLAYER.infField = null;
        }
      }

      // --- COOLDOWNS ---
      if (PLAYER.awakened) {
        for (let i=0;i<4;i++) {
          if (PLAYER.awkLock[i]) {
            PLAYER.awkCD[i]-=1/60;
            if (PLAYER.awkCD[i]<=0) { PLAYER.awkLock[i]=false; PLAYER.awkCD[i]=0;}
          }
        }
      }

      // --- AWK RESET ---
      if (PLAYER.awakened) {
        PLAYER.awkTimer ++;
        if (PLAYER.awkTimer > 1200) { // ~20s
          PLAYER.awakened = false;
          PLAYER.awk = 0;
        }
      }

      // --- RENDER ---
      draw();
      renderSkillsHUD();
      renderAwkBar();
      requestAnimationFrame(gameLoop);
    }

    // --- DRAW ---
    function draw() {
      ctx.clearRect(0,0,mapWidth,mapHeight);
      // chão
      ctx.fillStyle = "#3aa557";
      ctx.fillRect(0, groundY+62, mapWidth, mapHeight-groundY-62);

      // Infinito: campo
      if (PLAYER.infField) {
        ctx.save();
        ctx.globalAlpha = 0.13+0.08*Math.sin(PLAYER.infField.t/12);
        ctx.beginPath();
        ctx.arc(PLAYER.infField.x, PLAYER.infField.y, PLAYER.infField.r, 0, Math.PI*2);
        let grad = ctx.createRadialGradient(PLAYER.infField.x, PLAYER.infField.y, 20, PLAYER.infField.x, PLAYER.infField.y, PLAYER.infField.r);
        grad.addColorStop(0,"#fff"); grad.addColorStop(0.2,"#5cf"); grad.addColorStop(0.85,"#2b0e3e");
        grad.addColorStop(1,"#000");
        ctx.fillStyle = grad;
        ctx.fill();
        ctx.globalAlpha=1;
        ctx.restore();
      }

      // Azul Máximo
      if (PLAYER.blueSkyObj) {
        ctx.save();
        let grad = ctx.createRadialGradient(PLAYER.blueSkyObj.x, PLAYER.blueSkyObj.y, 12, PLAYER.blueSkyObj.x, PLAYER.blueSkyObj.y, PLAYER.blueSkyObj.r);
        grad.addColorStop(0,"#c5f6ff");
        grad.addColorStop(0.23,"#42c9fa");
        grad.addColorStop(1,"#1a3e7a");
        ctx.beginPath();
        ctx.arc(PLAYER.blueSkyObj.x,PLAYER.blueSkyObj.y,PLAYER.blueSkyObj.r,0,Math.PI*2);
        ctx.fillStyle = grad;
        ctx.shadowColor = "#88e0ff";
        ctx.shadowBlur = 28;
        ctx.globalAlpha = 0.93;
        ctx.fill();
        ctx.shadowBlur = 0;
        ctx.globalAlpha = 1;
        ctx.restore();
      }

      // Vermelho Máximo
      if (PLAYER.redObj) {
        ctx.save();
        if (PLAYER.redObj.state===0) {
          ctx.beginPath();
          ctx.arc(PLAYER.redObj.x, PLAYER.redObj.y, 13, 0, Math.PI*2);
          ctx.fillStyle = "#ff6a6a";
          ctx.shadowColor = "#faa";
          ctx.shadowBlur = 12;
          ctx.globalAlpha = .93;
          ctx.fill();
          ctx.shadowBlur = 0;
        } else if (PLAYER.redObj.state===1) {
          ctx.globalAlpha = 0.3;
          ctx.fillStyle = "#ff4444";
          ctx.fillRect(PLAYER.redObj.x, PLAYER.redObj.y-7, PLAYER.redObj.dir*160, 14);
          ctx.globalAlpha = 1;
        }
        ctx.restore();
      }

      // Bola roxa
      if (PLAYER.purpleObj) {
        ctx.save();
        let grad = ctx.createRadialGradient(PLAYER.purpleObj.x, PLAYER.purpleObj.y, 7, PLAYER.purpleObj.x, PLAYER.purpleObj.y, PLAYER.purpleObj.r);
        grad.addColorStop(0, "#fff");
        grad.addColorStop(0.14, "#e0b6ff");
        grad.addColorStop(0.44, "#a684e7");
        grad.addColorStop(1, "#3d006b");
        ctx.beginPath();
        ctx.arc(PLAYER.purpleObj.x,PLAYER.purpleObj.y,PLAYER.purpleObj.r,0,Math.PI*2);
        ctx.fillStyle = grad;
        ctx.shadowColor = "#fff";
        ctx.shadowBlur = 22;
        ctx.globalAlpha = 0.97;
        ctx.fill();
        ctx.globalAlpha = 1;
        ctx.shadowBlur = 0;
        ctx.restore();
      }

      // Gojo
      drawGojo(PLAYER.x, PLAYER.y, PLAYER.w, PLAYER.h, PLAYER.dir, PLAYER.awakened);

      // Inimigos
      for(let e of enemies) {
        if(!e.alive) continue;
        drawEnemy(e);
        // HP bar
        ctx.save();
        ctx.fillStyle = "#232";
        ctx.fillRect(e.x-2, e.y-9, e.w+4, 5);
        ctx.fillStyle = "#e06666";
        ctx.fillRect(e.x-2, e.y-9, (e.w+4)*e.hp/e.mhp, 5);
        ctx.strokeStyle = "#fff";
        ctx.lineWidth = 1;
        ctx.strokeRect(e.x-2, e.y-9, e.w+4, 5);
        ctx.restore();
      }
    }

    // --- SKILLS HUD ---
    function renderSkillsHUD() {
      const skills = [
        { n:"Azul Max.", k:"1", cd:PLAYER.awkCD[0], l:!PLAYER.awkLock[0], d:"Gira 3x e sobe<br>Interage com Vermelho" },
        { n:"Verm. Max.", k:"2", cd:PLAYER.awkCD[1], l:!PLAYER.awkLock[1], d:"Carrega e feixe<br>R: Combo soco<br>Interage com Azul" },
        { n:"Vazio Roxo", k:"3", cd:PLAYER.awkCD[2], l:!PLAYER.awkLock[2], d:"Aumenta segurando<br>Lança bola roxa" },
        { n:"Vazio Inf.", k:"4", cd:PLAYER.awkCD[3], l:!PLAYER.awkLock[3], d:"Campo paralisa 10s" },
      ];
      let html = "";
      if (!PLAYER.awakened) {
        html = `<span style="color:#69e1ff;">Awk: Acumule a barra batendo!</span>`;
      } else {
        for (let s of skills) {
          html += `<div class="skillLine">
            <span class="skKey">${s.k}</span>
            <span>${s.n}</span>
            <span class="${s.l?'':'skLock'}">${s.cd>0?s.cd.toFixed(1)+'s':''}</span>
          </div>`;
        }
      }
      document.getElementById('skillsHUD').innerHTML = html;
    }

    // --- AWK BAR ---
    function renderAwkBar() {
      const ratio = PLAYER.awk / PLAYER.awkMax;
      document.getElementById("awkBar").style.width = (ratio*100)+"%";
      document.getElementById("awkText").textContent = `Awk: ${(PLAYER.awk).toFixed(0)} / ${PLAYER.awkMax}`;
      document.getElementById("awkReady").style.display = (!PLAYER.awakened && PLAYER.awk>=PLAYER.awkMax) ? "" : "none";
    }

    // --- START ---
    spawnEnemy();
    spawnEnemy();
    spawnEnemy();
    requestAnimationFrame(gameLoop);
  </script>
</body>
</html>
